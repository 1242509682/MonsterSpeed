# MonsterSpeed 怪物加速插件

- 作者: 羽学
- 出处: Tshock官方群816771079
- 这是一个Tshock服务器插件，主要用于：
- 击中在配置中的“怪物ID”自动生成数据表，使其获得加速能力，根据怪物死亡次数自动减少：冷却时间与触发距离等


## 必看项目 👇
<details>
  <summary>进度限制表</summary>

```事件与进度```
- None (无) - 0
- EyeOfCthulhu (克眼, 克苏鲁之眼) - 1
- SlimeKing (史莱姆王, 史莱姆之王, 史王) - 2
- EvilBoss (克脑, 克苏鲁之脑, 世界吞噬者, 世界吞噬怪, 世吞) - 3
- Skeletron (骷髅王) - 4
- QueenBee (蜂王) - 5
- Deerclops (鹿角怪, 独眼巨鹿) - 6
- WallOfFlesh (血肉墙, 肉山, 肉后, 困难模式) - 7
- MechBossAny (一王后) - 8
- TheTwins (双子魔眼) - 9
- TheDestroyer (毁灭者, 铁长直) - 10
- SkeletronPrime (机械骷髅王) - 11
- Plantera (世纪之花, 世花) - 12
- Golem (石巨人) - 13
- DukeFishron (猪鲨, 猪龙鱼公爵) - 14
- LunaticCultist (拜月教邪教徒, 拜月) - 15
- Moonlord (月球领主, 月亮领主, 月总) - 16
- EmpressOfLight (光之女皇, 光女) - 17
- QieenSlime (史莱姆皇后, 史后) - 18
- HalloweenTree (哀木) - 19
- HalloweenKing (南瓜王) - 20
- ChristmasTree (长绿尖叫怪) - 21
- ChristmasIceQueen (冰雪女皇) - 22
- ChristmasSantank (圣诞坦克) - 23
- Martians (火星飞碟, 飞碟) - 24
- Clown (小丑) - 25
- TowerSolar (日耀柱) - 26
- TowerVortex (星旋柱) - 27
- TowerNebula (星云柱) - 28
- TowerStardust (星尘柱) - 29
- Goblins (哥布林入侵, 哥布林) - 30
- Pirates (海盗入侵, 海盗) - 31
- Frost (霜月) - 32
- BloodMoon (血月) - 33
- DrakMageT1 (旧日一, 黑暗法师) - 34
- OrgeT2 (旧日二, 巨魔) - 35
- BetsyT3 (旧日三, 贝蒂斯, 双足翼龙) - 36
- Raining (雨天) - 37
- DyaTime (白天) - 38
- Night (夜晚) - 39
- WindyDay (大风天) - 40
- Halloween (万圣节) - 41
- Party (派对) - 42

```世界种子```
- DrunkWorld (2020, 醉酒世界) - 43
- tenthAnniversaryWorld (2021, 十周年) - 44
- ForTheWorthy (ftw) - 45
- RemixWorld (混乱世界, 颠倒世界) - 46
- NotTheBeesWorld (ntb, 蜂蜜世界) - 47
- DontStarveWorld (永恒领域, 饥荒) - 48
- zenithWorld (天顶世界, 天顶) - 49
- NoTrapsWorld (陷阱世界, 陷阱) - 50

```月相```
- FullMoon (满月) - 51
- WaningGibbous (亏凸月) - 52
- ThirdQuarter (下弦月) - 53
- WaningCrescen (残月) - 54
- NewMoon (新月) - 55
- WaxingCrescent (娥眉月) - 56
- FirstQuarter (上弦月) - 57
- WaxingGibbous (盈凸月) - 58

</details>

<details>
  <summary>武器类型</summary>

- 无
- 未知 
- 近战
- 远程
- 魔法
- 召唤
- 悠悠球
- 投掷物
  </details>

## 更新日志

```
v1.2.0
 代码全面重构，移除【血量事件】将其与【时间事件】合并，作为【血量范围】触发条件
【时间事件】增加更多条件，当条件的值非-1时启用，
 当有【多个条件启用】时，默认视为完成所有【已激活条件】才会执行
 将【进度限制】从【生成弹幕】与【生成怪物】中移除放入到【时间事件】层方便统一编写
 优化了【自动仇恨机制】，移除了【怪物加速】逻辑，仅保留追击模式
 给【追击模式】加入了【传送】功能，避免一些无法穿墙的BOSS接近不了玩家
 在不满足【玩家武器、生命、防御】的时间事件逻辑时会根据【自动仇恨】寻找最近的玩家
 考虑到【战士】职业过于强势，【生命】与【防御】条件以小于【条件值】作为触发条件
【玩家武器】支持的类型为： 未知 | 近战 | 远程 | 魔法 | 召唤 | 悠悠球 | 投掷物
【召怪次数】与【弹发次数】会以单BOSS全局情况进行统一计数
（人话就是你必须写2个弹幕，其中一个方便给它提供计数）
 优化了【监控功能】可以查看到【当前时间事件】不可触发的原因
【监控间隔】设0为关闭，大于0则开启，推荐1000毫秒播报一次
 加入了【怪物头顶悬浮文字】，可以通过【倒计时文字间隔】来观察【时间事件】的更换倒计时
【每帧回血】修改为【每秒回血】，并按怪物血量上限的百分比回复，1则为1%,设0为关闭

v1.1.0
修复了【生成弹幕】其中一个的【进度限制】不达标，导致其余弹幕无法生成的问题
ps:【生成怪物】也可以跟【生成弹幕】一样写多个配置结构,并使用【进度限制】控制触发

v1.0.9
 简化了【生成弹幕】与【召唤怪物】的属性名称，【中心扩缩】改名为【半径】
【召唤怪物】改为List类型，并加入了【范围】、【间隔】、【以玩家为中心】属性
 给【生成怪物】与【生成弹幕】加入了【进度限制】

v1.0.8
【生成弹幕】加入了【每发间隔】、【中心扩缩】、【旋转角度】、【以玩家为中心】属性
 支持单次事件发射【多组弹幕】，可通过【每发间隔】来控制每次发射弹幕的冷却时间
 只有发完单组弹幕数量后才会切换下一组弹幕
 如果设置过长的【弹幕间隔】请注意更改事件本身【冷却时间】以确保下一组弹幕能够正常发射

v1.0.7
生成弹幕功能加入了【角度】与【弹幕AI】属性
随着弹幕数量增加自动衰减弹幕速度、变化弹幕的发射角度
修正了弹幕生命（持续帧数）的计算方式（不再支持-1写法）

v1.0.6
移除了AI风格
加入了自动转移仇恨机制
将隐藏的【冷却计数】与【更新时间】放入内存中计算,避免配置频繁写入
【时间事件】与【血量事件】加入了【召唤怪物】、【生成弹幕】功能
【监控广播】改为使用全员发送信息，不再遍历玩家是否在线
提高了怪物对玩家的位置判断准确性

v1.0.5
修复时间事件空引用
将时间事件和血量事件从触发距离内移出，仅在触发时间内起效
优化监控广播，只对mos.admin管理权限可见（时间:绿色为触发,玫红色为冷却）,可自定义播报间隔
注意：加速、血量、时间事件共用一个【冷却时间】触发，1次冷却为一个循环周期

v1.0.4
加入超距离追击模式
默认追击距离为50（可通过配置项修改）
当玩家与怪物距离超过追击距离时会以最高速度追击玩家
当追到触发最小距离时自动恢复原始速度
随着玩家击败BOSS次数逐渐减少这个缓冲距离
移除了Y轴加速配置项（做了距离向量算法优化）
预设了全BOSS怪物ID表
【切换智慧】更名为AI风格（可进入官方wiki搜索AI查询）
加入了/mos reset命令，用于清除【怪物数据表】

v1.0.3
将【AI赋值】更名为：血量事件
将【AI循环】更名为：时间事件
并将其格式转换为List数据表
加入了【触发距离外回血】配置项：
当怪物不处于【触发距离】且仍有【触发秒数】时会持续回血（冷却时间与触发加速时不回）
给【血量事件】【时间事件】加入了【切换智慧】配置项（当值为-1时，保持默认）
首次击中怪物可获取到其【切换智慧】值

v1.0.2
隐藏了更新时间与冷却次数配置项
给【ai赋值】加入了血量条件
加入ai监控配置项（此监控仅在触发的有效时间与距离内会全服广播）
考虑到不是所有怪物都具备ai[1]移除默认填写值
(不会写AI循环的可以不写，建议多学习写【血量AI赋值】)
【AI赋值】中第一个字符串是执行修改的血量范围,不再此范围则默认不修改
【AI循环】中第一个数字是执行顺序，再每次冷却结束后按顺序执行，数字内的{}才是ai键值

v1.0.1
加入了伤怪建表法
加入了AI循环：
根据冷却时间自动增加冷却次数，根据冷却次数自动循环AI（移除数组）
根据  "怪物ID"自动填写AI循环中的ai[1] 0.0-3.0的循环值

v1.0.0
羽学自己写的小玩具，
根据角色与怪物之间的距离自动给BOSS实现加速与AI赋值
```

## 指令

| 语法                             | 别名  |       权限       |                   说明                   |
| -------------------------------- | :---: | :--------------: | :--------------------------------------: |
| /mos  | 无 |   mos.admin    |    指令菜单    |
| /mos reset | 无 |   mos.admin    |    重置怪物数据表    |
| /reload  | 无 |   tshock.cfg.reload    |    重载配置文件    |

## 配置
> 配置文件位置：tshock/怪物加速.json
```json
{
  "武器条件说明": "无 | 未知 | 近战 | 远程 | 魔法 | 召唤 | 悠悠球 | 投掷物",
  "进度条件说明": [
    "-1不判断 | 0 无 | 1 克眼 | 2 史王 | 3 世吞克脑 | 4 骷髅王 | 5 蜂王 | 6 巨鹿 | 7 肉后",
    "8 一王后 | 9 双子魔眼 | 10 毁灭者 | 11 铁骷髅王 | 12 世花 | 13 石巨人 | 14 猪鲨",
    "15 拜月 | 16 月总 | 17 光女 | 18 史后 | 19 哀木 | 20 南瓜王 | 21 尖叫怪 | 22 冰雪女皇",
    "23 圣诞坦克 | 24 飞碟 | 25 小丑 | 26 日耀柱 | 27 星旋柱 | 28 星云柱 | 29 星尘柱",
    "30 哥布林 | 31 海盗 | 32 霜月 | 33 血月 | 34 旧日一 | 35 旧日二 | 36 双足翼龙",
    "37 雨天 | 38 白天 | 39 夜晚 | 40 大风天 | 41 万圣节 | 42 派对 | 43 醉酒种子 | 44 十周年",
    "45 ftw种子 | 46 颠倒种子 | 47 蜂蜜种子 | 48 饥荒种子 | 49 天顶种子 | 50 陷阱种子",
    "51 满月 | 52 亏凸月 | 53 下弦月 | 54 残月 | 55 新月 | 56 娥眉月 | 57 上弦月 | 58 盈凸月"
  ],
  "插件开关": true,
  "监控间隔": 100.0,
  "怪物ID表": [],
  "怪物数据表": {
    "史莱姆王": {
      "死亡次数": 1,
      "自动仇恨": true,
      "追击距离": 62.0,
      "停追距离": 25.0,
      "追击速度": 35,
      "传送冷却": 10,
      "免疫陷阱": false,
      "免疫熔岩": false,
      "能够穿墙": false,
      "修改防御": -1,
      "每秒回血": 1,
      "冷却时间": 5.0,
      "倒计时文字间隔": 1000.0,
      "时间事件": [
        {
          "血量范围": "75,100",
          "进度限制": -1,
          "玩家生命": -1,
          "玩家防御": -1,
          "玩家武器": "近战",
          "召怪次数": -1,
          "弹发次数": -1,
          "死亡次数": -1,
          "距离条件": -1.0,
          "速度条件": -1.0,
          "怪物AI": {},
          "生成怪物": [
            {
              "怪物ID": [
                184,
                204
              ],
              "范围": 25,
              "数量": 5,
              "间隔": 300.0,
              "以玩家为中心": false
            }
          ],
          "生成弹幕": [
            {
              "弹幕ID": 671,
              "伤害": 10,
              "数量": 10,
              "间隔": 5.0,
              "击退": 8,
              "速度": 50.0,
              "半径": 10.0,
              "偏移": 15.0,
              "旋转": 0.0,
              "弹幕AI": {},
              "生命周期": 120,
              "以玩家为中心": false
            }
          ]
        },
        {
          "血量范围": "0,75",
          "进度限制": -1,
          "玩家生命": -1,
          "玩家防御": -1,
          "玩家武器": "无",
          "召怪次数": -1,
          "弹发次数": -1,
          "死亡次数": -1,
          "距离条件": -1.0,
          "速度条件": -1.0,
          "怪物AI": {},
          "生成怪物": [
            {
              "怪物ID": [
                658,
                659,
                660
              ],
              "范围": 25,
              "数量": 2,
              "间隔": 300.0,
              "以玩家为中心": false
            }
          ],
          "生成弹幕": [
            {
              "弹幕ID": 351,
              "伤害": 10,
              "数量": 30,
              "间隔": 1.0,
              "击退": 8,
              "速度": 20.0,
              "半径": 0.0,
              "偏移": 360.0,
              "旋转": 2.0,
              "弹幕AI": {
                "0": 50.0
              },
              "生命周期": 60,
              "以玩家为中心": false
            }
          ]
        }
      ]
    },
    "克苏鲁之眼": {
      "死亡次数": 0,
      "自动仇恨": true,
      "追击距离": 62.0,
      "停追距离": 25.0,
      "追击速度": 35,
      "传送冷却": -1,
      "免疫陷阱": false,
      "免疫熔岩": false,
      "能够穿墙": false,
      "修改防御": -1,
      "每秒回血": 1,
      "冷却时间": 5.0,
      "倒计时文字间隔": 1000.0,
      "时间事件": [
        {
          "血量范围": "0,100",
          "进度限制": -1,
          "玩家生命": -1,
          "玩家防御": -1,
          "玩家武器": "无",
          "召怪次数": -1,
          "弹发次数": -1,
          "死亡次数": -1,
          "距离条件": -1.0,
          "速度条件": -1.0,
          "怪物AI": {},
          "生成怪物": [
            {
              "怪物ID": [
                5
              ],
              "范围": 25,
              "数量": 5,
              "间隔": 300.0,
              "以玩家为中心": false
            }
          ],
          "生成弹幕": [
            {
              "弹幕ID": 115,
              "伤害": 10,
              "数量": 15,
              "间隔": 2.0,
              "击退": 8,
              "速度": 25.0,
              "半径": 15.0,
              "偏移": 5.0,
              "旋转": 0.0,
              "弹幕AI": {
                "0": 50.0
              },
              "生命周期": 180,
              "以玩家为中心": false
            },
            {
              "弹幕ID": 44,
              "伤害": 10,
              "数量": 15,
              "间隔": 5.0,
              "击退": 8,
              "速度": 10.0,
              "半径": 4.0,
              "偏移": 15.0,
              "旋转": 0.0,
              "弹幕AI": {},
              "生命周期": 120,
              "以玩家为中心": false
            }
          ]
        },
        {
          "血量范围": "0,100",
          "进度限制": -1,
          "玩家生命": -1,
          "玩家防御": -1,
          "玩家武器": "无",
          "召怪次数": -1,
          "弹发次数": -1,
          "死亡次数": -1,
          "距离条件": -1.0,
          "速度条件": -1.0,
          "怪物AI": {},
          "生成怪物": [
            {
              "怪物ID": [
                133
              ],
              "范围": 25,
              "数量": 2,
              "间隔": 300.0,
              "以玩家为中心": false
            }
          ],
          "生成弹幕": [
            {
              "弹幕ID": 814,
              "伤害": 10,
              "数量": 15,
              "间隔": 10.0,
              "击退": 8,
              "速度": 100.0,
              "半径": 0.0,
              "偏移": 15.0,
              "旋转": 2.0,
              "弹幕AI": {},
              "生命周期": 180,
              "以玩家为中心": false
            },
            {
              "弹幕ID": 454,
              "伤害": 20,
              "数量": 15,
              "间隔": 10.0,
              "击退": 8,
              "速度": 105.0,
              "半径": 0.0,
              "偏移": 5.0,
              "旋转": 0.0,
              "弹幕AI": {
                "0": 50.0
              },
              "生命周期": 60,
              "以玩家为中心": false
            }
          ]
        }
      ]
    },
    "世界吞噬怪": {
      "死亡次数": 0,
      "自动仇恨": true,
      "追击距离": 155.0,
      "停追距离": 25.0,
      "追击速度": 35,
      "传送冷却": 20,
      "免疫陷阱": false,
      "免疫熔岩": false,
      "能够穿墙": false,
      "修改防御": -1,
      "每秒回血": 1,
      "冷却时间": 5.0,
      "倒计时文字间隔": 1000.0,
      "时间事件": []
    },
    "毁灭者": {
      "死亡次数": 0,
      "自动仇恨": true,
      "追击距离": 124.0,
      "停追距离": 25.0,
      "追击速度": 35,
      "传送冷却": 20,
      "免疫陷阱": false,
      "免疫熔岩": false,
      "能够穿墙": false,
      "修改防御": -1,
      "每秒回血": 1,
      "冷却时间": 5.0,
      "倒计时文字间隔": 1000.0,
      "时间事件": []
    }
  }
}
```
## 反馈
- 优先发issued -> 共同维护的插件库：https://github.com/UnrealMultiple/TShockPlugin
- 次优先：TShock官方群：816771079
- 大概率看不到但是也可以：国内社区trhub.cn ，bbstr.net , tr.monika.love
